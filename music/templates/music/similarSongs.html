{% extends "_base.html" %}
{% block title %}Panašios dainos › Muzikos sistema{% endblock %}

{% block content %}
<div class="d-flex justify-content-between align-items-start mb-4">
  <h2 class="fw-semibold mb-0">Panašios dainos</h2>
  <a href="{% url 'music:index' %}" class="btn btn-primary">Atgal</a>
</div>

{% if errors %}
<div class="alert alert-danger" role="alert">
  <ul class="mb-0">
    {% for error in errors %}
    <li>{{ error }}</li>
    {% endfor %}
  </ul>
</div>
{% endif %}

{% if info %}
<div class="alert alert-info" role="alert">
  {{ info }}
</div>
{% endif %}

{% if target_song %}
<div class="card bg-body-tertiary shadow-sm mb-4">
  <div class="card-body">
    <h4 class="card-title mb-1">{{ target_song.pavadinimas }}</h4>
    <p class="mb-1 text-secondary">Žanras: {{ target_song.get_zanras_display }}</p>
    {% if target_song.isleidimo_data %}
    <p class="mb-0 text-secondary">Išleidimo data: {{ target_song.isleidimo_data }}</p>
    {% endif %}
  </div>
</div>
{% endif %}

<div class="card bg-body-tertiary shadow-sm">
  <div class="card-body">
    <h5 class="card-title mb-3">Rekomenduojamos</h5>
    {% if similar_songs %}
    <div class="row g-3">
      {% for song in similar_songs %}
      <div class="col-md-6 col-lg-4">
        <div class="card h-100 border border-secondary">
          <div class="card-body">
            <h6 class="card-title mb-1">{{ song.pavadinimas }}</h6>
            <p class="card-subtitle text-secondary mb-2">
              Žanras: {{ song.get_zanras_display }} 
            </p>
            {% if song.isleidimo_data %}
            <p class="mb-2 small text-secondary">Išleista: {{ song.isleidimo_data }}</p>
            {% endif %}
          </div>
          <div class="card-footer bg-transparent border-top border-secondary">
            <div class="d-flex flex-wrap gap-2">
              <a href="{% url 'music:playSong' song.pk %}" class="btn btn-sm btn-primary">Klausyti</a>
              {% if "user" in request.session and song.savininkas.pk == request.session.user_id %}
                <a href="{% url 'music:editSong' %}?song={{ song.pk }}" class="btn btn-sm btn-primary">Redaguoti</a>
              {% endif %}
            </div>
          </div>
        </div>
      </div>
      {% endfor %}
    </div>
    {% else %}
    <p class="text-secondary mb-0">Panašių dainų nerasta.</p>
    {% endif %}
  </div>
</div>
{% endblock %}
