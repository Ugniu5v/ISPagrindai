{% extends "_base.html" %}
{% block title %}Įvertinti dainą › Muzikos sistema{% endblock %}

{% block content %}
<div class="d-flex justify-content-between align-items-start mb-4">
  <h2 class="fw-semibold mb-0">Įvertinti dainą</h2>
  <a href="{% url 'music:index' %}" class="btn btn-primary">Atgal</a>
</div>

{% if success_message %}
<div class="alert alert-success" role="alert">
  {{ success_message }}
</div>
{% endif %}

{% if errors %}
<div class="alert alert-danger" role="alert">
  <ul class="mb-0">
    {% for error in errors %}
    <li>{{ error }}</li>
    {% endfor %}
  </ul>
</div>
{% endif %}

<div class="card bg-body-tertiary shadow-sm">
  <div class="card-body">
    <form method="post" action="{% url 'music:rateSong' %}">
      {% csrf_token %}
      {% if selected_song %}
      <div class="mb-3">
        <label class="form-label">Daina</label>
        <input type="text" class="form-control" value="{{ selected_song.pavadinimas }}" disabled>
        <input type="hidden" name="song" value="{{ selected_song.pk }}">
      </div>
      {% else %}
      <div class="mb-3">
        <label for="song" class="form-label">Pasirinkite dainą *</label>
        <select class="form-select" id="song" name="song">
          <option value="">Pasirinkti</option>
          {% for s in songs %}
          <option value="{{ s.pk }}" {% if request.GET.song|default:'' == s.pk|stringformat:'s' %}selected{% endif %}>{{ s.pavadinimas }}</option>
          {% endfor %}
        </select>
      </div>
      {% endif %}

      <div class="mb-3">
        <label for="rating" class="form-label">Įvertinimas (1-5) *</label>
        <input type="number" class="form-control" id="rating" name="rating" min="1" max="5" step="1" value="{{ rating_value|default:'' }}">
      </div>

      <div class="d-flex gap-2">
        <button type="submit" class="btn btn-primary">Išsaugoti įvertinimą</button>
        <a href="{% url 'music:index' %}" class="btn btn-secondary">Atšaukti</a>
      </div>
    </form>
  </div>
</div>
{% endblock %}
